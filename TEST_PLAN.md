# TestPaperBundle 测试计划

## 测试范围

### 1. 实体测试

#### QuestionBank
- [ ] 创建题库
- [ ] 设置属性（名称、学科、年级等）
- [ ] 关联题目和知识点
- [ ] API数组转换

#### Question
- [ ] 创建各种题型的题目
- [ ] 设置选项和正确答案
- [ ] 关联知识点
- [ ] 使用次数和正确率统计
- [ ] 标签管理
- [ ] API数组转换（含答案/不含答案）

#### KnowledgePoint
- [ ] 创建知识点
- [ ] 设置层级关系
- [ ] 权重管理
- [ ] 关联题目

#### TestPaper
- [ ] 创建试卷
- [ ] 设置基本属性（标题、时限、分数等）
- [ ] 试卷状态管理
- [ ] 考试设置（重考、显示答案等）
- [ ] 试卷类型继承（PracticePaper、ExamPaper、AdaptivePaper）

#### PaperTemplate
- [ ] 创建组卷模板
- [ ] 添加组卷规则
- [ ] 规则优先级管理

#### TestSession
- [ ] 创建考试会话
- [ ] 状态转换（待考、进行中、已完成）
- [ ] 答案提交
- [ ] 计时功能
- [ ] 单题计时

### 2. 服务测试

#### PaperGeneratorService
- [ ] 模板组卷
  - [ ] 基础规则匹配
  - [ ] 优先级处理
  - [ ] 题目不足处理
- [ ] 随机组卷
  - [ ] 难度分布
  - [ ] 题型分布
  - [ ] 排除已用题目
- [ ] 智能组卷
  - [ ] 知识点覆盖
  - [ ] 权重分配
  - [ ] 冲突解决
- [ ] 题目顺序随机
- [ ] 选项顺序随机

#### QuestionSelectorService
- [ ] 按条件选题
- [ ] 排除最近使用的题目
- [ ] 优先选择低使用率题目
- [ ] 避免题目重复

#### TestSessionService
- [ ] 创建会话
  - [ ] 检查考试次数限制
  - [ ] 设置到期时间
- [ ] 开始考试
- [ ] 提交答案
  - [ ] 单选题
  - [ ] 多选题
  - [ ] 填空题
  - [ ] 其他题型
- [ ] 完成考试
  - [ ] 计算得分
  - [ ] 判断及格
  - [ ] 更新统计
- [ ] 处理超时会话

#### PaperScoringService
- [ ] 基础评分
  - [ ] 单选题评分
  - [ ] 多选题评分
  - [ ] 判断题评分
  - [ ] 填空题评分
  - [ ] 连线题评分
  - [ ] 排序题评分
- [ ] 部分评分
  - [ ] 多选题部分得分
  - [ ] 填空题部分得分
  - [ ] 连线题部分得分
- [ ] 详细结果分析
- [ ] 按题型统计
- [ ] 按难度统计
- [ ] 按知识点统计

#### PracticePaperService
- [ ] 快速练习
  - [ ] 按题型练习
  - [ ] 按难度练习
- [ ] 知识点专项练习
- [ ] 自适应练习
- [ ] 综合练习
- [ ] 练习推荐

#### WrongQuestionAnalysisService
- [ ] 获取用户错题
- [ ] 生成错题试卷
  - [ ] 按错误次数筛选
  - [ ] 限制题目数量
- [ ] 错题模式分析
  - [ ] 按难度分析
  - [ ] 按题型分析
  - [ ] 按知识点分析
- [ ] 练习建议生成

### 3. Repository测试

#### QuestionRepository
- [ ] 按题库查询
- [ ] 按题型和难度查询
- [ ] 按知识点查询
- [ ] 搜索功能
- [ ] 统计功能
- [ ] 相似题目查询

#### TestSessionRepository
- [ ] 按用户查询
- [ ] 按试卷查询
- [ ] 查找活动会话
- [ ] 查找过期会话
- [ ] 统计分析
  - [ ] 平均分
  - [ ] 及格率
  - [ ] 成绩分布
- [ ] 用户历史记录

#### PaperQuestionRepository
- [ ] 按试卷查询题目
- [ ] 包含题目详情查询

### 4. 集成测试

#### 完整考试流程
- [ ] 创建题库和题目
- [ ] 生成试卷
- [ ] 创建考试会话
- [ ] 答题过程
- [ ] 自动评分
- [ ] 结果分析

#### 组卷流程
- [ ] 模板组卷完整流程
- [ ] 随机组卷完整流程
- [ ] 智能组卷完整流程

#### 错题分析流程
- [ ] 多次考试产生错题
- [ ] 错题统计分析
- [ ] 生成错题试卷
- [ ] 错题练习

### 5. 边界测试

#### 异常情况处理
- [ ] 题库题目不足
- [ ] 组卷规则冲突
- [ ] 考试超时
- [ ] 重复提交答案
- [ ] 并发考试

#### 性能测试
- [ ] 大题库组卷性能
- [ ] 批量评分性能
- [ ] 统计查询性能

### 6. 安全测试

- [ ] 答案不泄露给前端
- [ ] 考试时间控制
- [ ] 考试次数限制
- [ ] 权限控制

## 测试数据准备

### 基础数据
1. 创建测试题库（数学、英语、物理）
2. 每个题库创建50+道题目，覆盖所有题型
3. 创建知识点体系（3层结构）
4. 创建组卷模板

### 用户数据
1. 创建测试用户
2. 模拟考试记录
3. 生成错题数据

## 测试工具

- PHPUnit：单元测试和集成测试
- Doctrine DataFixtures：测试数据准备
- Symfony Test Bundle：功能测试

## 测试执行

```bash
# 运行所有测试
vendor/bin/phpunit

# 运行特定测试
vendor/bin/phpunit tests/Service/PaperGeneratorServiceTest.php

# 生成覆盖率报告
vendor/bin/phpunit --coverage-html coverage/
```